(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{Pn0e:function(t,e,i){"use strict";i.r(e),i.d(e,"SubscribersModule",(function(){return Ft}));var o=i("mrSG"),s=i("UxUN"),a=i("0IaG"),n=i("3Pt+"),l=i("fXoL"),r=i("j7lE"),c=i("dWDE"),u=i("/t3+"),h=i("kmnG"),p=i("bTqV"),d=i("NFeN"),b=i("qFsG"),m=i("u47x"),f=i("8LU1"),g=i("FKr1"),_=i("quSY"),v=i("XNiG"),y=i("NXyV"),O=i("VRyK"),w=i("LRne"),S=i("xgIS"),R=i("ofXK"),k=i("rDax"),A=i("vxfF"),C=i("FtGj"),x=i("nLfN"),M=i("+rOU"),P=i("IzEk"),I=i("eIep"),D=i("pLZG"),F=i("lJxs"),j=i("vkgz"),E=i("3E0/"),B=i("cH1L");const T=["panel"];function L(t,e){if(1&t&&(l.Sb(0,"div",0,1),l.ic(2),l.Rb()),2&t){const t=l.ec();l.kc("id",t.id)("ngClass",t._classList)}}const z=["*"];let V=0;class W{constructor(t,e){this.source=t,this.option=e}}class N{}const H=Object(g.v)(N),G=new l.r("mat-autocomplete-default-options",{providedIn:"root",factory:function(){return{autoActiveFirstOption:!1}}});let U=(()=>{class t extends H{constructor(t,e,i){super(),this._changeDetectorRef=t,this._elementRef=e,this._activeOptionChanges=_.a.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new l.o,this.opened=new l.o,this.closed=new l.o,this.optionActivated=new l.o,this._classList={},this.id="mat-autocomplete-"+V++,this._autoActiveFirstOption=!!i.autoActiveFirstOption}get isOpen(){return this._isOpen&&this.showPanel}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(t){this._autoActiveFirstOption=Object(f.c)(t)}set classList(t){this._classList=t&&t.length?t.split(" ").reduce((t,e)=>(t[e.trim()]=!0,t),{}):{},this._setVisibilityClasses(this._classList),this._elementRef.nativeElement.className=""}ngAfterContentInit(){this._keyManager=new m.b(this.options).withWrap(),this._activeOptionChanges=this._keyManager.change.subscribe(t=>{this.optionActivated.emit({source:this,option:this.options.toArray()[t]||null})}),this._setVisibility()}ngOnDestroy(){this._activeOptionChanges.unsubscribe()}_setScrollTop(t){this.panel&&(this.panel.nativeElement.scrollTop=t)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(t){const e=new W(this,t);this.optionSelected.emit(e)}_setVisibilityClasses(t){t[this._visibleClass]=this.showPanel,t[this._hiddenClass]=!this.showPanel}}return t.\u0275fac=function(e){return new(e||t)(l.Mb(l.h),l.Mb(l.l),l.Mb(G))},t.\u0275dir=l.Hb({type:t,viewQuery:function(t,e){var i;1&t&&(l.vc(l.M,!0),l.Hc(T,!0)),2&t&&(l.oc(i=l.bc())&&(e.template=i.first),l.oc(i=l.bc())&&(e.panel=i.first))},inputs:{displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",classList:["class","classList"],panelWidth:"panelWidth"},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[l.xb]}),t})(),K=(()=>{class t extends U{constructor(){super(...arguments),this._visibleClass="mat-autocomplete-visible",this._hiddenClass="mat-autocomplete-hidden"}}return t.\u0275fac=function(e){return X(e||t)},t.\u0275cmp=l.Gb({type:t,selectors:[["mat-autocomplete"]],contentQueries:function(t,e,i){var o;1&t&&(l.Fb(i,g.e,!0),l.Fb(i,g.k,!0)),2&t&&(l.oc(o=l.bc())&&(e.optionGroups=o),l.oc(o=l.bc())&&(e.options=o))},hostAttrs:[1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[l.zb([{provide:g.f,useExisting:t}]),l.xb],ngContentSelectors:z,decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(t,e){1&t&&(l.jc(),l.zc(0,L,3,2,"ng-template"))},directives:[R.j],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),t})();const X=l.Ub(K),$=new l.r("mat-autocomplete-scroll-strategy"),q={provide:$,deps:[k.c],useFactory:function(t){return()=>t.scrollStrategies.reposition()}},Y={provide:n.m,useExisting:Object(l.U)(()=>Q),multi:!0};let J=(()=>{class t{constructor(t,e,i,o,s,a,n,l,r,c){this._element=t,this._overlay=e,this._viewContainerRef=i,this._zone=o,this._changeDetectorRef=s,this._dir=n,this._formField=l,this._document=r,this._viewportRuler=c,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=_.a.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new v.a,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=Object(y.a)(()=>this.autocomplete&&this.autocomplete.options?Object(O.a)(...this.autocomplete.options.map(t=>t.onSelectionChange)):this._zone.onStable.pipe(Object(P.a)(1),Object(I.a)(()=>this.optionSelections))),this._scrollStrategy=a}get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(t){this._autocompleteDisabled=Object(f.c)(t)}ngAfterViewInit(){const t=this._getWindow();void 0!==t&&this._zone.runOutsideAngular(()=>t.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(t){t.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const t=this._getWindow();void 0!==t&&t.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this.autocomplete.closed.emit(),this.autocomplete._isOpen=this._overlayAttached=!1,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return Object(O.a)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(Object(D.a)(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(Object(D.a)(()=>this._overlayAttached)):Object(w.a)()).pipe(Object(F.a)(t=>t instanceof g.m?t:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return Object(O.a)(Object(S.a)(this._document,"click"),Object(S.a)(this._document,"touchend")).pipe(Object(D.a)(t=>{const e=this._isInsideShadowRoot&&t.composedPath?t.composedPath()[0]:t.target,i=this._formField?this._formField._elementRef.nativeElement:null,o=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&e!==this._element.nativeElement&&(!i||!i.contains(e))&&(!o||!o.contains(e))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(e)}))}writeValue(t){Promise.resolve(null).then(()=>this._setTriggerValue(t))}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this._element.nativeElement.disabled=t}_handleKeydown(t){const e=t.keyCode;if(e!==C.h||Object(C.r)(t)||t.preventDefault(),this.activeOption&&e===C.g&&this.panelOpen)this.activeOption._selectViaInteraction(),this._resetActiveItem(),t.preventDefault();else if(this.autocomplete){const i=this.autocomplete._keyManager.activeItem,o=e===C.o||e===C.e;this.panelOpen||e===C.n?this.autocomplete._keyManager.onKeydown(t):o&&this._canOpen()&&this.openPanel(),(o||this.autocomplete._keyManager.activeItem!==i)&&this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0)}}_handleInput(t){let e=t.target,i=e.value;"number"===e.type&&(i=""==i?null:parseFloat(i)),this._previousValue!==i&&(this._previousValue=i,this._onChange(i),this._canOpen()&&this._document.activeElement===t.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_floatLabel(t=!1){this._formField&&"auto"===this._formField.floatLabel&&(t?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField.floatLabel="auto",this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const t=this._zone.onStable.pipe(Object(P.a)(1)),e=this.autocomplete.options.changes.pipe(Object(j.a)(()=>this._positionStrategy.reapplyLastPosition()),Object(E.a)(0));return Object(O.a)(t,e).pipe(Object(I.a)(()=>{const t=this.panelOpen;return this._resetActiveItem(),this.autocomplete._setVisibility(),this.panelOpen&&(this._overlayRef.updatePosition(),t!==this.panelOpen&&this.autocomplete.opened.emit()),this.panelClosingActions}),Object(P.a)(1)).subscribe(t=>this._setValueAndClose(t))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_setTriggerValue(t){const e=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(t):t,i=null!=e?e:"";this._formField?this._formField._control.value=i:this._element.nativeElement.value=i,this._previousValue=i}_setValueAndClose(t){t&&t.source&&(this._clearPreviousSelectedOption(t.source),this._setTriggerValue(t.source.value),this._onChange(t.source.value),this._element.nativeElement.focus(),this.autocomplete._emitSelectEvent(t.source)),this.closePanel()}_clearPreviousSelectedOption(t){this.autocomplete.options.forEach(e=>{e!==t&&e.selected&&e.deselect()})}_attachOverlay(){null==this._isInsideShadowRoot&&(this._isInsideShadowRoot=!!Object(x.c)(this._element.nativeElement));let t=this._overlayRef;t?(this._positionStrategy.setOrigin(this._getConnectedElement()),t.updateSize({width:this._getPanelWidth()})):(this._portal=new M.h(this.autocomplete.template,this._viewContainerRef),t=this._overlay.create(this._getOverlayConfig()),this._overlayRef=t,t.keydownEvents().subscribe(t=>{(t.keyCode===C.h&&!Object(C.r)(t)||t.keyCode===C.o&&Object(C.r)(t,"altKey"))&&(this._resetActiveItem(),this._closeKeyEventStream.next(),t.stopPropagation(),t.preventDefault())}),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&t&&t.updateSize({width:this._getPanelWidth()})})),t&&!t.hasAttached()&&(t.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const e=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.panelOpen&&e!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){return new k.d({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir})}_getOverlayPosition(){const t=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(t),this._positionStrategy=t,t}_setStrategyPositions(t){const e=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],i=this._aboveClass,o=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:i},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:i}];let s;s="above"===this.position?o:"below"===this.position?e:[...e,...o],t.withPositions(s)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){this.autocomplete._keyManager.setActiveItem(this.autocomplete.autoActiveFirstOption?0:-1)}_canOpen(){const t=this._element.nativeElement;return!t.readOnly&&!t.disabled&&!this._autocompleteDisabled}_getWindow(){var t;return(null===(t=this._document)||void 0===t?void 0:t.defaultView)||window}_scrollToOption(t){const e=this.autocomplete,i=Object(g.s)(t,e.options,e.optionGroups);if(0===t&&1===i)e._setScrollTop(0);else{const i=e.options.toArray()[t];if(i){const t=i._getHostElement(),o=Object(g.t)(t.offsetTop,t.offsetHeight,e._getScrollTop(),e.panel.nativeElement.offsetHeight);e._setScrollTop(o)}}}}return t.\u0275fac=function(e){return new(e||t)(l.Mb(l.l),l.Mb(k.c),l.Mb(l.Q),l.Mb(l.A),l.Mb(l.h),l.Mb($),l.Mb(B.b,8),l.Mb(h.a,9),l.Mb(R.d,8),l.Mb(A.e))},t.\u0275dir=l.Hb({type:t,inputs:{position:["matAutocompletePosition","position"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"],autocomplete:["matAutocomplete","autocomplete"],connectedTo:["matAutocompleteConnectedTo","connectedTo"]},features:[l.yb]}),t})(),Q=(()=>{class t extends J{constructor(){super(...arguments),this._aboveClass="mat-autocomplete-panel-above"}}return t.\u0275fac=function(e){return Z(e||t)},t.\u0275dir=l.Hb({type:t,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(t,e){1&t&&l.ac("focusin",(function(){return e._handleFocus()}))("blur",(function(){return e._onTouched()}))("input",(function(t){return e._handleInput(t)}))("keydown",(function(t){return e._handleKeydown(t)})),2&t&&l.Bb("autocomplete",e.autocompleteAttribute)("role",e.autocompleteDisabled?null:"combobox")("aria-autocomplete",e.autocompleteDisabled?null:"list")("aria-activedescendant",e.panelOpen&&e.activeOption?e.activeOption.id:null)("aria-expanded",e.autocompleteDisabled?null:e.panelOpen.toString())("aria-owns",e.autocompleteDisabled||!e.panelOpen||null==e.autocomplete?null:e.autocomplete.id)("aria-haspopup",!e.autocompleteDisabled)},exportAs:["matAutocompleteTrigger"],features:[l.zb([Y]),l.xb]}),t})();const Z=l.Ub(Q);let tt=(()=>{class t{}return t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({factory:function(e){return new(e||t)},providers:[q],imports:[[k.f,g.l,g.h,R.c],A.b,g.l,g.h]}),t})();var et=i("d3UM"),it=i("Xa2L");function ot(t,e){1&t&&l.Nb(0,"mat-progress-spinner",14)}function st(t,e){if(1&t&&(l.Sb(0,"mat-option",11),l.Bc(1),l.Rb()),2&t){const t=e.$implicit;l.kc("value",t.email),l.Ab(1),l.Dc(" ",t.email," ")}}function at(t,e){if(1&t&&(l.Sb(0,"mat-error"),l.Bc(1),l.Rb()),2&t){const t=l.ec();l.Ab(1),l.Dc(" ",t.errors.email," ")}}function nt(t,e){if(1&t&&(l.Sb(0,"mat-error"),l.Bc(1),l.Rb()),2&t){const t=l.ec();l.Ab(1),l.Dc(" ",t.errors.role," ")}}let lt=(()=>{class t{constructor(t,e,i,o){this.users=t,this.dialog=e,this.config=i,this.formerror=o,this.form=new n.f({role:new n.c(1,[n.w.required]),email:new n.c(null,[n.w.required,n.w.email])}),this.errors={role:"",email:""},this.subscribers={}}close(){this.dialog.close(!1)}submit(){this.dialog.close(this.form.value)}ngOnInit(){this.subscribers.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),null!=this.config&&(null!=this.config.role&&this.form.controls.role.setValue(this.config.role),null!=this.config.email&&(this.form.controls.email.setValue(this.config.email),this.form.controls.email.disable())),this.subscribers.email=this.form.controls.email.valueChanges.subscribe(t=>Object(o.a)(this,void 0,void 0,(function*(){if(t.length>=3){this.loading=!0;const e=yield this.users.list({filter:["email"],email:t});this.users.data=e.ok?e.result.map(t=>new s.a(t)):[],this.loading=!1}else this.users.data=[]})))}ngOnDestroy(){this.subscribers.form.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(l.Mb(r.a),l.Mb(a.d),l.Mb(a.a),l.Mb(c.a))},t.\u0275cmp=l.Gb({type:t,selectors:[["user-editor-dialog"]],decls:33,vars:11,consts:[[1,"spacer"],["type","button","mat-icon-button","",3,"click"],[3,"formGroup","ngSubmit"],["appearance","outline"],["matInput","","type","email","name","email","placeholder","email","autocomplete","false","formControlName","email","required","",3,"matAutocomplete"],["mode","indeterminate","color","primary","diameter","24","matSuffix","",4,"ngIf"],["autoActiveFirstOption",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["name","role","placeholder","role","formControlName","role","required",""],[3,"value"],["disabled","",3,"value"],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate","color","primary","diameter","24","matSuffix",""]],template:function(t,e){if(1&t&&(l.Sb(0,"mat-toolbar"),l.Sb(1,"mat-label",0),l.Bc(2," Manage User "),l.Rb(),l.Sb(3,"button",1),l.ac("click",(function(){return e.close()})),l.Sb(4,"mat-icon"),l.Bc(5,"close"),l.Rb(),l.Rb(),l.Rb(),l.Sb(6,"form",2),l.ac("ngSubmit",(function(){return!e.form.invalid&&e.submit()})),l.Sb(7,"mat-form-field",3),l.Sb(8,"mat-label"),l.Bc(9," Email "),l.Rb(),l.Nb(10,"input",4),l.zc(11,ot,1,0,"mat-progress-spinner",5),l.Sb(12,"mat-autocomplete",6,7),l.zc(14,st,2,2,"mat-option",8),l.Rb(),l.zc(15,at,2,1,"mat-error",9),l.Rb(),l.Sb(16,"mat-form-field",3),l.Sb(17,"mat-label"),l.Bc(18," Role "),l.Rb(),l.Sb(19,"mat-select",10),l.Sb(20,"mat-option",11),l.Bc(21," Read "),l.Rb(),l.Sb(22,"mat-option",11),l.Bc(23," Write "),l.Rb(),l.Sb(24,"mat-option",11),l.Bc(25," Read/Write "),l.Rb(),l.Sb(26,"mat-option",11),l.Bc(27," Admin "),l.Rb(),l.Sb(28,"mat-option",12),l.Bc(29," Owner "),l.Rb(),l.Rb(),l.zc(30,nt,2,1,"mat-error",9),l.Rb(),l.Sb(31,"button",13),l.Bc(32," submit "),l.Rb(),l.Rb()),2&t){const t=l.pc(13);l.Ab(6),l.kc("formGroup",e.form),l.Ab(4),l.kc("matAutocomplete",t),l.Ab(1),l.kc("ngIf",e.loading),l.Ab(3),l.kc("ngForOf",e.users.data),l.Ab(1),l.kc("ngIf",e.errors.email),l.Ab(5),l.kc("value",1),l.Ab(2),l.kc("value",2),l.Ab(2),l.kc("value",3),l.Ab(2),l.kc("value",4),l.Ab(2),l.kc("value",5),l.Ab(2),l.kc("ngIf",e.errors.role)}},directives:[u.a,h.g,p.b,d.a,n.x,n.p,n.g,h.c,b.a,n.b,Q,n.o,n.e,n.v,R.l,K,R.k,et.a,g.k,it.a,h.h,h.b],styles:[".user-editor-dialog{width:500px!important}.user-editor-dialog .mat-dialog-container{padding:0 0 10px!important}.user-editor-dialog .mat-dialog-container mat-toolbar{display:flex;font-size:14px;margin-bottom:5px;justify-content:center}@media screen and (max-width:600px){.user-editor-dialog .mat-dialog-container{top:0;left:0;right:0;bottom:0;z-index:5000;position:fixed;border-radius:0}}"],encapsulation:2}),t})();var rt=i("+0xr"),ct=i("xyCQ"),ut=i("L7HW"),ht=i("9ZKQ"),pt=i("tyNb"),dt=i("BhS5"),bt=i("RgeU"),mt=i("znSr"),ft=i("MutI");function gt(t,e){1&t&&(l.Sb(0,"th",11),l.Bc(1," Email "),l.Rb())}function _t(t,e){if(1&t&&(l.Sb(0,"td",12),l.Bc(1),l.Rb()),2&t){const t=e.$implicit;l.Ab(1),l.Dc(" ",t.email," ")}}function vt(t,e){1&t&&(l.Sb(0,"th",11),l.Bc(1," Status "),l.Rb())}function yt(t,e){if(1&t){const t=l.Tb();l.Sb(0,"td",12),l.Sb(1,"mat-select",13),l.ac("ngModelChange",(function(i){return l.rc(t),e.$implicit.status=i}))("ngModelChange",(function(i){l.rc(t);const o=e.$implicit;return l.ec().status(o.userId,i)})),l.Sb(2,"mat-option",14),l.Bc(3," Accepted "),l.Rb(),l.Sb(4,"mat-option",15),l.Bc(5," Rejected "),l.Rb(),l.Sb(6,"mat-option",16),l.Bc(7," Requested "),l.Rb(),l.Rb(),l.Rb()}if(2&t){const t=e.$implicit,i=l.ec();l.Ab(1),l.kc("ngModel",t.status)("disabled",i.role<4||t.role>=i.role||5==t.role)}}function Ot(t,e){1&t&&(l.Sb(0,"th",11),l.Bc(1," Role "),l.Rb())}function wt(t,e){if(1&t){const t=l.Tb();l.Sb(0,"td",12),l.Sb(1,"mat-select",13),l.ac("ngModelChange",(function(i){return l.rc(t),e.$implicit.role=i}))("ngModelChange",(function(i){l.rc(t);const o=e.$implicit;return l.ec().updatesubscriber(o.userId,i)})),l.Sb(2,"mat-option",17),l.Bc(3," None "),l.Rb(),l.Sb(4,"mat-option",18),l.Bc(5," Read "),l.Rb(),l.Sb(6,"mat-option",18),l.Bc(7," Write "),l.Rb(),l.Sb(8,"mat-option",18),l.Bc(9," Read/Write "),l.Rb(),l.Sb(10,"mat-option",18),l.Bc(11," Admin "),l.Rb(),l.Sb(12,"mat-option",17),l.Bc(13," Owner "),l.Rb(),l.Rb(),l.Rb()}if(2&t){const t=e.$implicit,i=l.ec();l.Ab(1),l.kc("ngModel",t.role)("disabled",0==t.role||i.role<4||t.role>=i.role||5==t.role),l.Ab(1),l.kc("value",0),l.Ab(2),l.kc("value",1),l.Ab(2),l.kc("value",2),l.Ab(2),l.kc("value",3),l.Ab(2),l.kc("value",4),l.Ab(2),l.kc("value",5)}}function St(t,e){1&t&&l.Nb(0,"th",11)}function Rt(t,e){if(1&t){const t=l.Tb();l.Sb(0,"td",12),l.Sb(1,"button",19),l.ac("click",(function(){l.rc(t);const i=e.$implicit;return l.ec().unsubscribe(i.userId)})),l.Sb(2,"mat-icon"),l.Bc(3," delete "),l.Rb(),l.Rb(),l.Rb()}if(2&t){const t=e.$implicit,i=l.ec();l.Ab(1),l.kc("disabled",i.role<4||t.role>=i.role||5==t.role)}}function kt(t,e){1&t&&l.Nb(0,"tr",20)}function At(t,e){1&t&&l.Nb(0,"tr",21)}function Ct(t,e){if(1&t){const t=l.Tb();l.Sb(0,"mat-list-item",22),l.Sb(1,"mat-label"),l.Sb(2,"h3"),l.Bc(3),l.Rb(),l.Sb(4,"p"),l.Bc(5),l.Rb(),l.Rb(),l.Sb(6,"button",23),l.ac("click",(function(){l.rc(t);const i=e.$implicit;return l.ec().editor(i)})),l.Sb(7,"mat-icon"),l.Bc(8," edit "),l.Rb(),l.Rb(),l.Sb(9,"button",19),l.ac("click",(function(){l.rc(t);const i=e.$implicit;return l.ec().unsubscribe(i.userId)})),l.Sb(10,"mat-icon"),l.Bc(11," delete "),l.Rb(),l.Rb(),l.Rb()}if(2&t){const t=e.$implicit,i=l.ec();l.Ab(3),l.Dc(" ",t.email," "),l.Ab(2),l.Gc(" ",1==t.role?"Read":""," ",2==t.role?"Write":""," ",3==t.role?"Read/Write":""," ",4==t.role?"Admin":""," ",5==t.role?"Owner":""," "),l.Ab(1),l.kc("disabled",i.role<4||t.role>=i.role||5==t.role),l.Ab(3),l.kc("disabled",i.role<4||t.role>=i.role||5==t.role)}}let xt=(()=>{class t{constructor(t,e,i,o,s,a,n){this.apps=t,this.config=e,this.dialog=i,this.toast=o,this.route=s,this.buttons=a,this.tokens=n,this.users=new rt.k,this.columns=["email","status","role","options"],this.subscriptions={}}get(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const t={filter:["role","name","users","description"]};let e;switch(this.type){case"app":e=this.apps,t.appId=this.id;break;case"token":e=this.tokens,t.tokenId=this.id}const i=yield e.get(t);i.ok?(this.role=i.result.role,this.users.data=i.result.users,this.description=i.result.name||i.result.description):this.users.data=[],this.loading=!1}))}share(t){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const e={role:t.role,email:t.email};let i;switch(this.type){case"app":i=this.apps,e.appId=this.id;break;case"token":i=this.tokens,e.tokenId=this.id}const o=yield i.share(e);o.ok?(t.userId=o.result.userId,this.users.data.push(t),this.users.data=JSON.parse(JSON.stringify(this.users.data)),this.toast.show("User was shared!")):this.toast.show(o.error.message),this.loading=!1}))}editor(t){return Object(o.a)(this,void 0,void 0,(function*(){(yield this.dialog.open(lt,{data:t,panelClass:"user-editor-dialog"})).afterClosed().subscribe(e=>{e&&(t?this.updatesubscriber(t.userId,e.role):this.share(e))})}))}unsubscribe(t){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const e={userId:t};let i;switch(this.type){case"app":i=this.apps,e.appId=this.id;break;case"token":i=this.tokens,e.tokenId=this.id}const o=yield i.unsubscribe(e);if(o.ok){for(let e=0;e<this.users.data.length;e++)this.users.data[e].userId==t&&this.users.data.splice(e,1);this.users.data=JSON.parse(JSON.stringify(this.users.data)),this.toast.show("User was removed!")}else this.toast.show(o.error.message);this.loading=!1}))}status(t,e){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;let i=0;"accepted"==e&&(i=1);const o={role:i,userId:t,status:e};let a;switch(this.type){case"app":a=this.apps,o.appId=this.id;break;case"token":a=this.tokens,o.tokenId=this.id}const n=yield a.updatesubscriber(o);if(n.ok){if("accepted"==e){for(let t=0;t<this.users.data.length;t++);this.users.data.map(e=>{e.userId==t&&(e.role=1)}),this.users.data=this.users.data.map(t=>new s.a(t))}this.toast.show("User was updated!")}else this.toast.show(n.error.message);this.loading=!1}))}updatesubscriber(t,e){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const i={role:e,userId:t};let o;switch(this.type){case"app":o=this.apps,i.appId=this.id;break;case"token":o=this.tokens,i.tokenId=this.id}const s=yield o.updatesubscriber(i);this.toast.show(s.ok?"User was updated!":s.error.message),this.loading=!1}))}ngOnInit(){this.buttons.show("add"),this.buttons.show("close"),this.buttons.hide("search"),this.buttons.hide("filter"),this.subscriptions.add=this.buttons.add.click.subscribe(t=>{this.editor()}),this.subscriptions.close=this.buttons.close.click.subscribe(t=>{window.history.back()}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>{if(t){const t=this.route.snapshot.queryParams;this.id=t.id,this.type=t.type,this.get()}})}ngOnDestroy(){this.subscriptions.add.unsubscribe(),this.subscriptions.close.unsubscribe(),this.subscriptions.loaded.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(l.Mb(ct.a),l.Mb(ut.a),l.Mb(a.b),l.Mb(ht.a),l.Mb(pt.a),l.Mb(dt.a),l.Mb(bt.a))},t.\u0275cmp=l.Gb({type:t,selectors:[["subscribers-page"]],decls:22,vars:7,consts:[["mat-table","","fxShow","","fxHide.xs","true",3,"dataSource"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","role"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full",4,"ngFor","ngForOf"],["mat-header-cell",""],["mat-cell",""],["required","",3,"ngModel","disabled","ngModelChange"],["value","accepted"],["value","rejected"],["value","requested"],["disabled","",3,"value"],[3,"value"],["mat-icon-button","","color","warn",3,"disabled","click"],["mat-header-row",""],["mat-row",""],["lines","full"],["mat-icon-button","",3,"disabled","click"]],template:function(t,e){1&t&&(l.Sb(0,"mat-toolbar"),l.Sb(1,"mat-label"),l.Bc(2),l.Sb(3,"span"),l.Bc(4),l.Rb(),l.Rb(),l.Rb(),l.Sb(5,"table",0),l.Qb(6,1),l.zc(7,gt,2,0,"th",2),l.zc(8,_t,2,1,"td",3),l.Pb(),l.Qb(9,4),l.zc(10,vt,2,0,"th",2),l.zc(11,yt,8,2,"td",3),l.Pb(),l.Qb(12,5),l.zc(13,Ot,2,0,"th",2),l.zc(14,wt,14,8,"td",3),l.Pb(),l.Qb(15,6),l.zc(16,St,1,0,"th",2),l.zc(17,Rt,4,1,"td",3),l.Pb(),l.zc(18,kt,1,0,"tr",7),l.zc(19,At,1,0,"tr",8),l.Rb(),l.Sb(20,"mat-list",9),l.zc(21,Ct,12,8,"mat-list-item",10),l.Rb()),2&t&&(l.Ab(2),l.Dc(" ",e.description," "),l.Ab(2),l.Dc(" ",e.type," "),l.Ab(1),l.kc("dataSource",e.users),l.Ab(13),l.kc("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),l.Ab(1),l.kc("matRowDefColumns",e.columns),l.Ab(2),l.kc("ngForOf",e.users.data))},directives:[u.a,h.g,rt.j,mt.a,rt.c,rt.e,rt.b,rt.g,rt.i,ft.a,R.k,rt.d,rt.a,et.a,n.v,n.o,n.r,g.k,p.b,d.a,rt.f,rt.h,ft.b],styles:[".mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{width:100%}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{margin-right:auto}mat-toolbar[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px;margin-left:8px;line-height:12px;border-radius:24px;text-transform:uppercase;background-color:#fff}"]}),t})();var Mt=i("wZkO"),Pt=i("YUcS"),It=i("H0Zp");const Dt=[{path:"",component:xt}];let Ft=(()=>{class t{}return t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({factory:function(e){return new(e||t)},imports:[[n.i,R.c,Mt.a,d.b,ft.c,rt.l,b.b,g.q,a.c,p.c,et.b,It.a,u.b,Pt.a,h.e,n.u,tt,it.b,pt.g.forChild(Dt)]]}),t})()}}]);