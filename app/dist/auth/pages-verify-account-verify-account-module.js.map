{"version":3,"sources":["./src/app/pages/verify-account/verify-account.module.ts","./src/app/pages/verify-account/verify-account.page.ts","./src/app/pages/verify-account/verify-account.page.html"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAmB;AACuC;AAE1D,qBAAqB;AACoB;AACM;AACQ;AACA;AACE;AACE;AACA;AACH;AACK;AACA;AACkB;AACA;AACb;AACX;AACe;AACQ;AACZ;;;AAElE,MAAM,MAAM,GAAW;IACtB;QACC,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,sEAAiB;KAC5B;CACD,CAAC;AA2BK,MAAM,mBAAmB;;kGAAnB,mBAAmB;gKAAnB,mBAAmB,kBAxBtB;YACR,2DAAW;YACX,4DAAY;YACZ,oEAAa;YACb,oEAAa;YACb,sEAAc;YACd,wEAAe;YACf,wEAAe;YACf,0EAAgB;YAChB,qEAAgB;YAChB,2EAAgB;YAChB,6FAAgB;YAChB,6FAAgB;YAChB,gFAAkB;YAClB,mEAAmB;YACnB,oFAAoB;YACpB,4FAAwB;YACxB,6DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;SAC7B;mIAMW,mBAAmB,mBAJ9B,sEAAiB,aAnBjB,2DAAW;QACX,4DAAY;QACZ,oEAAa;QACb,oEAAa;QACb,sEAAc;QACd,wEAAe;QACf,wEAAe;QACf,0EAAgB;QAChB,qEAAgB;QAChB,2EAAgB;QAChB,6FAAgB;QAChB,6FAAgB;QAChB,gFAAkB;QAClB,mEAAmB;QACnB,oFAAoB;QACpB,4FAAwB;6FAQb,mBAAmB;cAzB/B,sDAAQ;eAAC;gBACT,OAAO,EAAE;oBACR,2DAAW;oBACX,4DAAY;oBACZ,oEAAa;oBACb,oEAAa;oBACb,sEAAc;oBACd,wEAAe;oBACf,wEAAe;oBACf,0EAAgB;oBAChB,qEAAgB;oBAChB,2EAAgB;oBAChB,6FAAgB;oBAChB,6FAAgB;oBAChB,gFAAkB;oBAClB,mEAAmB;oBACnB,oFAAoB;oBACpB,4FAAwB;oBACxB,6DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;iBAC7B;gBACD,YAAY,EAAE;oBACb,sEAAiB;iBACjB;aACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9C4D;AACO;;;;;;;;;;;;;;;;;ICgBxD,4EACI;IAAA,uDACJ;IAAA,4DAAY;;;IADR,0DACJ;IADI,+FACJ;;;IAUA,4EACI;IAAA,uDACJ;IAAA,4DAAY;;;IADR,0DACJ;IADI,8FACJ;;;IAMA,qFAAgG;;AD5BrG,MAAM,iBAAiB;IAE7B,YAAoB,IAAiB,EAAU,KAAmB,EAAU,KAAqB,EAAU,MAAqB,EAAU,MAAc,EAAU,OAAuB,EAAU,SAA2B;QAA1M,SAAI,GAAJ,IAAI,CAAa;QAAU,UAAK,GAAL,KAAK,CAAc;QAAU,UAAK,GAAL,KAAK,CAAgB;QAAU,WAAM,GAAN,MAAM,CAAe;QAAU,WAAM,GAAN,MAAM,CAAQ;QAAU,YAAO,GAAP,OAAO,CAAgB;QAAU,cAAS,GAAT,SAAS,CAAkB;QAEvN,QAAG,GAAQ,EAAG,CAAC;QACf,SAAI,GAAc,IAAI,wDAAS,CAAC;YACtC,IAAI,EAAE,IAAI,0DAAW,CAAC,IAAI,EAAE,CAAC,yDAAU,CAAC,QAAQ,EAAE,yDAAU,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,yDAAU,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,yDAAU,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,yDAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YACpJ,KAAK,EAAE,IAAI,0DAAW,CAAC,IAAI,EAAE,CAAC,yDAAU,CAAC,KAAK,EAAE,yDAAU,CAAC,QAAQ,CAAC,CAAC;SACrE,CAAC,CAAC;QAEI,WAAM,GAAQ;YACpB,IAAI,EAAE,EAAE;YACR,KAAK,EAAE,EAAE;SACT,CAAC;QAEM,kBAAa,GAAQ,EAAE,CAAC;IAbkM,CAAC;IAerN,IAAI;;YACjB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YAEpB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;gBACrC,MAAM,EAAE;oBACP,KAAK;oBACL,MAAM;oBACN,MAAM;iBACN;gBACD,KAAK,EAAE,IAAI,CAAC,KAAK;aACjB,CAAC,CAAC;YAEH,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;YAErB,IAAI,QAAQ,CAAC,EAAE,EAAE;gBAChB,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAC,MAAM,CAAC;gBAC3B,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;oBACvB,IAAI,CAAC,MAAM,EAAE,CAAC;iBACd;aACD;iBAAM;gBACN,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;aACtC;QACF,CAAC;KAAA;IAEY,MAAM;;YAClB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YAEpB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC1C,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI;gBAC1B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK;aAC5B,CAAC,CAAC;YAEH,IAAI,QAAQ,CAAC,EAAE,EAAE;gBAChB,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC;gBAC/C,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;oBAC1C,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,eAAe,CAAC,EAAE;wBACvC,WAAW,EAAE;4BACZ,KAAK,EAAE,MAAM,CAAC,KAAK;4BACnB,KAAK,EAAE,MAAM,CAAC,KAAK;4BACnB,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,eAAe;yBACtC;wBACD,UAAU,EAAE,IAAI;qBAChB,CAAC,CAAC;iBACH;qBAAM;oBACN,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,EAAE;wBACjC,WAAW,EAAE;4BACZ,KAAK,EAAE,MAAM,CAAC,KAAK;yBACnB;wBACD,UAAU,EAAE,IAAI;qBAChB,CAAC,CAAC;iBACH;aACD;iBAAM;gBACN,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;aACxC;YAED,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACtB,CAAC;KAAA;IAED,QAAQ;QACP,IAAI,CAAC,aAAa,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;YACjE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE;YACjE,IAAI,MAAM,EAAE;gBACX,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC;gBAC/C,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,WAAW,IAAI,MAAM,CAAC,IAAI,KAAK,IAAI,EAAE;oBAChE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;iBAC9C;gBACD,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,WAAW,IAAI,MAAM,CAAC,KAAK,KAAK,IAAI,EAAE;oBAClE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;iBAChD;gBACD,IAAI,OAAM,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,WAAW,IAAI,MAAM,CAAC,KAAK,KAAK,IAAI,EAAE;oBACjE,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;oBAC1B,IAAI,CAAC,IAAI,EAAE,CAAC;iBACZ;qBAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;oBAC9B,IAAI,CAAC,MAAM,EAAE,CAAC;iBACd;aACD;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,WAAW;QACV,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QACtC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;IACzC,CAAC;;kFAtGW,iBAAiB;iGAAjB,iBAAiB;QCf9B,8EACI;QAAA,oEAEA;QAAA,qEACI;QAAA,uDACJ;QAAA,4DAAK;QAEL,qEACI;QAAA,2EACJ;QAAA,4DAAK;QAEL,oEACI;QAAA,wMACJ;QAAA,4DAAI;QAEJ,0EACI;QADqB,kKAA6B,YAAQ,IAAC;QAC3D,oFACI;QAAA,6EACI;QAAA,mEACJ;QAAA,4DAAY;QAEZ,uEAEA;QAAA,2HACI;QAER,4DAAiB;QAEjB,qFACI;QAAA,6EACI;QAAA,+EACJ;QAAA,4DAAY;QAEZ,uEAEA;QAAA,2HACI;QAER,4DAAiB;QAEjB,6EACI;QAAA,wDAEA;QAAA,iJAAyE;QAC7E,4DAAS;QAET,6EACI;QAAA,kEACJ;QAAA,4DAAS;QACb,4DAAO;QACX,4DAAc;;QAjDL,0DAA+D;QAA/D,6LAA+D;QAGhE,0DACJ;QADI,gHACJ;QAUM,0DAAkB;QAAlB,+EAAkB;QAQL,0DAAoB;QAApB,kFAAoB;QAYpB,0DAAmB;QAAnB,iFAAmB;QAM9B,0DAEA;QAFA,+GAEA;QAAyD,0DAAe;QAAf,6EAAe;;6FD5BvE,iBAAiB;cAN7B,uDAAS;eAAC;gBACV,QAAQ,EAAE,qBAAqB;gBAC/B,SAAS,EAAE,CAAC,4BAA4B,CAAC;gBACzC,WAAW,EAAE,4BAA4B;aACzC","file":"pages-verify-account-verify-account-module.js","sourcesContent":["/* --- PAGES --- */\r\nimport { VerifyAccountPage } from './verify-account.page';\r\n\r\n/* --- MODULES --- */\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatListModule } from '@angular/material/list';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { FlexLayoutModule } from '@angular/flex-layout';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { MatToolbarModule } from '@angular/material/toolbar';\r\nimport { MatContentModule } from 'src/app/libs/mat-content/mat-content.module';\r\nimport { BackButtonModule } from 'src/app/libs/back-button/back-button.module';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nconst routes: Routes = [\r\n\t{\r\n\t\tpath: '',\r\n\t\tcomponent: VerifyAccountPage\r\n\t}\r\n];\r\n\r\n@NgModule({\r\n\timports: [\r\n\t\tFormsModule,\r\n\t\tCommonModule,\r\n\t\tMatIconModule,\r\n\t\tMatListModule,\r\n\t\tMatInputModule,\r\n\t\tMatButtonModule,\r\n\t\tMatSelectModule,\r\n\t\tMatTooltipModule,\r\n\t\tFlexLayoutModule,\r\n\t\tMatToolbarModule,\r\n\t\tBackButtonModule,\r\n\t\tMatContentModule,\r\n\t\tMatFormFieldModule,\r\n\t\tReactiveFormsModule,\r\n\t\tMatSlideToggleModule,\r\n\t\tMatProgressSpinnerModule,\r\n\t\tRouterModule.forChild(routes)\r\n\t],\r\n\tdeclarations: [\r\n\t\tVerifyAccountPage\r\n\t]\r\n})\r\n\r\nexport class VerifyAccountModule { }\r\n","import { AppsService } from 'src/app/services/apps/apps.service';\r\nimport { ToastService } from 'src/app/services/toast/toast.service';\r\nimport { ConfigService } from 'src/app/services/config/config.service';\r\nimport { AccountService } from 'src/app/services/account/account.service';\r\nimport { FormErrorService } from 'src/app/services/form-error/form-error.service';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { OnInit, Component, OnDestroy } from '@angular/core';\r\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\r\n\r\n@Component({\r\n\tselector: 'verify-account-page',\r\n\tstyleUrls: ['./verify-account.page.scss'],\r\n\ttemplateUrl: './verify-account.page.html'\r\n})\r\n\r\nexport class VerifyAccountPage implements OnInit, OnDestroy {\r\n\r\n\tconstructor(private apps: AppsService, private toast: ToastService, private route: ActivatedRoute, private config: ConfigService, private router: Router, private service: AccountService, private formerror: FormErrorService) { }\r\n\r\n\tpublic app: any = { };\r\n\tpublic form: FormGroup = new FormGroup({\r\n\t\tcode: new FormControl(null, [Validators.required, Validators.min(100000), Validators.max(999999), Validators.minLength(6), Validators.maxLength(6)]),\r\n\t\temail: new FormControl(null, [Validators.email, Validators.required])\r\n\t});\r\n\tpublic appId: string;\r\n\tpublic errors: any = {\r\n\t\tcode: '',\r\n\t\temail: ''\r\n\t};\r\n\tpublic loading: boolean;\r\n\tprivate subscriptions: any = {};\r\n\r\n\tprivate async load() {\r\n\t\tthis.loading = true;\r\n\r\n\t\tconst response = await this.apps.load({\r\n\t\t\tfilter: [\r\n\t\t\t\t'url',\r\n\t\t\t\t'icon',\r\n\t\t\t\t'name'\r\n\t\t\t],\r\n\t\t\tappId: this.appId\r\n\t\t});\r\n\r\n\t\tthis.loading = false;\r\n\r\n\t\tif (response.ok) {\r\n\t\t\tthis.app = response.result;\r\n\t\t\tif (!this.form.invalid) {\r\n\t\t\t\tthis.submit();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.toast.show('Issue loading app!');\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async submit() {\r\n\t\tthis.loading = true;\r\n\r\n\t\tconst response = await this.service.verify({\r\n\t\t\tcode: this.form.value.code,\r\n\t\t\temail: this.form.value.email\r\n\t\t});\r\n\r\n\t\tif (response.ok) {\r\n\t\t\tconst params = this.route.snapshot.queryParams;\r\n\t\t\tif (Object.keys(this.app).includes('url')) {\r\n\t\t\t\tthis.router.navigate(['/allow-access'], {\r\n\t\t\t\t\tqueryParams: {\r\n\t\t\t\t\t\tappId: params.appId,\r\n\t\t\t\t\t\temail: params.email,\r\n\t\t\t\t\t\treturl: this.app.url + '/authenticate'\r\n\t\t\t\t\t},\r\n\t\t\t\t\treplaceUrl: true\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.router.navigate(['/signin'], {\r\n\t\t\t\t\tqueryParams: {\r\n\t\t\t\t\t\temail: params.email\r\n\t\t\t\t\t},\r\n\t\t\t\t\treplaceUrl: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.toast.show(response.error.message);\r\n\t\t}\r\n\r\n\t\tthis.loading = false;\r\n\t}\r\n\r\n\tngOnInit(): void {\r\n\t\tthis.subscriptions.form = this.form.valueChanges.subscribe(data => {\r\n\t\t\tthis.errors = this.formerror.validateForm(this.form, this.errors, true);\r\n\t\t});\r\n\r\n\t\tthis.subscriptions.loaded = this.config.loaded.subscribe(loaded => {\r\n\t\t\tif (loaded) {\r\n\t\t\t\tconst params = this.route.snapshot.queryParams;\r\n\t\t\t\tif (typeof (params.code) != 'undefined' && params.code !== null) {\r\n\t\t\t\t\tthis.form.controls.code.setValue(params.code);\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof (params.email) != 'undefined' && params.email !== null) {\r\n\t\t\t\t\tthis.form.controls.email.setValue(params.email);\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof(params.appId) != 'undefined' && params.appId !== null) {\r\n\t\t\t\t\tthis.appId = params.appId;\r\n\t\t\t\t\tthis.load();\r\n\t\t\t\t} else if (!this.form.invalid) {\r\n\t\t\t\t\tthis.submit();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tngOnDestroy(): void {\r\n\t\tthis.subscriptions.form.unsubscribe();\r\n\t\tthis.subscriptions.loaded.unsubscribe();\r\n\t}\r\n\r\n}\r\n","<mat-content>\r\n    <img [src]=\"app.icon ? app.icon : './assets/icons/icon-512x512.png'\" alt=\"icon\" width=\"100\" height=\"100\">\r\n\r\n    <h1>\r\n        {{ app.name ? app.name : 'Auth' }}\r\n    </h1>\r\n\r\n    <h2>\r\n        Verify Account\r\n    </h2>\r\n\r\n    <p>\r\n        You will recieve and email with your veification code. You must enter the code below or click the link in the email to verify your account!\r\n    </p>\r\n\r\n    <form [formGroup]=\"form\" (ngSubmit)=\"!form.invalid && submit()\">\r\n        <mat-form-field appearance=\"outline\">\r\n            <mat-label>\r\n                Email\r\n            </mat-label>\r\n\r\n            <input matInput type=\"email\" name=\"email\" placeholder=\"email\" formControlName=\"email\" required>\r\n\r\n            <mat-error *ngIf=\"errors.email\">\r\n                {{ errors.email }}\r\n            </mat-error>\r\n        </mat-form-field>\r\n\r\n        <mat-form-field appearance=\"outline\">\r\n            <mat-label>\r\n                Verification Code\r\n            </mat-label>\r\n            \r\n            <input matInput min=\"100000\" max=\"999999\" minlength=\"6\" maxlength=\"6\" type=\"number\" name=\"code\" placeholder=\"code\" formControlName=\"code\" required>\r\n    \r\n            <mat-error *ngIf=\"errors.code\">\r\n                {{ errors.code }}\r\n            </mat-error>\r\n        </mat-form-field>\r\n\r\n        <button type=\"submit\" mat-flat-button color=\"primary\">\r\n            {{ loading ? '' : 'verify account' }}\r\n\r\n            <mat-progress-spinner mode=\"indeterminate\" diameter=\"30\" *ngIf=\"loading\"></mat-progress-spinner>\r\n        </button>\r\n\r\n        <button type=\"button\" mat-stroked-button color=\"primary\" back-button>\r\n            back\r\n        </button>\r\n    </form>\r\n</mat-content>"],"sourceRoot":"webpack:///"}